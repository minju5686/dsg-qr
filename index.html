<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta property="og:image" content="https://minju5686.github.io/dsg-qr/images/preview.png" />
  <meta property="og:title" content="광주동성여자중학교 QR 스탬프 투어" />
  <meta property="og:description" content="7명의 선생님 캐릭터 스탬프를 모아 리워드를 받아보세요!" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://minju5686.github.io/dsg-qr/" />
  <link href="https://fonts.googleapis.com/css2?family=UhBee+Seulvely&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>광주동성여자중학교 QR 스탬프 투어</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    /* (CSS 생략, 기존 스타일 그대로 유지) */
  </style>
</head>
<body>

<div id="page-start">
  <h1>광주동성여자중학교 QR 스탬프 투어</h1>
  <img src="https://minju5686.github.io/dsg-qr/images/preview.png" alt="미리보기 이미지" style="width:90%; max-width:320px; border-radius:12px; margin-bottom:20px;" />
  <button onclick="navigateToPage('page-form')">시작하기</button>
</div>

<div id="page-form" class="hidden">
  <h2>인적사항 입력</h2>
  <input type="text" id="name" placeholder="이름" />
  <input type="number" id="grade" placeholder="학년" />
  <input type="number" id="classNum" placeholder="반" />
  <input type="number" id="number" placeholder="번호" />
  <button onclick="startTour()">투어 시작</button>
</div>

<div id="page-stamps" class="hidden">
  <h2>내 스탬프</h2>
  <div id="stampBook"></div>
  <input type="text" id="qrInput" placeholder="QR 코드 입력" />
  <button onclick="startCamera()">도장 찍기</button>
  <div id="qr-reader" style="width:300px; margin:20px auto; display:none;"></div>
</div>

<div id="page-complete" class="hidden">
  <h2>🎉 축하합니다!</h2>
  <p>7개의 도장을 모두 모았습니다!</p>
</div>

<script>
function toggleMenu() { /* ... */ }
function navigateToPage(pageId) {
  const pages = ['page-start', 'page-form', 'page-stamps', 'page-complete', 'schedule'];
  pages.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.classList.add('hidden');
  });
  document.getElementById(pageId).classList.remove('hidden');
}
function startCamera() { /* ... */ }
function startTour() { /* ... */ }
function showStamps() { /* ... */ }
function submitQR(code = null) { /* ... */ }

window.onload = () => {
  const params = new URLSearchParams(window.location.search);
  const qrCodeParam = params.get("code");
  const userInfo = JSON.parse(localStorage.getItem("userInfo"));
  if (userInfo) {
    const stampKey = `stamps_${userInfo.name}_${userInfo.grade}_${userInfo.classNum}_${userInfo.number}`;
    localStorage.setItem("stampKey", stampKey);
    if (qrCodeParam) {
      submitQR(qrCodeParam);
    } else {
      showStamps();
      navigateToPage('page-stamps');
    }
  } else {
    navigateToPage('page-start');
  }
};
</script>

</body>
</html>
